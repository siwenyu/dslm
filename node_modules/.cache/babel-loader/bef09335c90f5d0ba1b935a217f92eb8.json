{"ast":null,"code":"/*!\n * Viewer.js v1.6.1\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2020-06-14T07:47:18.114Z\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.Viewer = factory());\n})(this, function () {\n  'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n\n    /**\n     * Enable to request fullscreen when play.\n     * @type {boolean}\n     */\n    fullscreen: true,\n\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n\n    /**\n     * Define the initial index of image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    zoom: null,\n    zoomed: null\n  };\n  var TEMPLATE = '<div class=\"viewer-container\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\"></div>' + '<div role=\"button\" class=\"viewer-button\" data-viewer-action=\"mix\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer'; // Actions\n\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom'; // Classes\n\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\"); // Events\n\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_HIDE = 'hide';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_READY = 'ready';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_WHEEL = 'wheel';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed'; // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\"); // RegExps\n\n  var REGEXP_SPACES = /\\s\\s*/; // Misc\n\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * Check if the given value is not a number.\n   */\n\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n          var length = data.length;\n          var i;\n\n          for (i = 0; i < length; i += 1) {\n            if (callback.call(data, data[i], i, data) === false) {\n              break;\n            }\n          }\n        } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n\n\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return obj;\n  };\n\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n\n\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n\n  function dispatchEvent(element, type, data) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, {\n        detail: data,\n        bubbles: true,\n        cancelable: true\n      });\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n\n\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n\n  var IS_SAFARI = WINDOW.navigator && /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img'); // Modern browsers (except Safari)\n\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n\n    var body = document.body || document.documentElement;\n\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src; // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n\n    return newImage;\n  }\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n\n\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n\n      default:\n        return '';\n    }\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n          parent = this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n\n      var element = this.element,\n          options = this.options,\n          list = this.list;\n      var items = []; // initList may be called in this.update, so should keep idempotent\n\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n\n        var url = _this.getImageURL(image);\n\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n          img.src = src || url;\n          img.alt = alt;\n          img.setAttribute('data-index', index);\n          img.setAttribute('data-original-url', url || src);\n          img.setAttribute('data-viewer-action', 'view');\n          img.setAttribute('role', 'button');\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        setData(image, 'filled', true);\n\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n\n        addListener(image, EVENT_LOAD, function (event) {\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n      });\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList(index) {\n      var i = index || this.index;\n      var width = this.items[i].offsetWidth || 30;\n      var outerWidth = width + 1; // 1 pixel of `margin-left` width\n      // Place the active item in the center of the screen\n\n      setStyle(this.list, assign({\n        width: outerWidth * this.length\n      }, getTransforms({\n        translateX: (this.viewerData.width - width) / 2 - outerWidth * i\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n\n      var options = this.options,\n          image = this.image,\n          viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = Math.min(width * 0.9, naturalWidth);\n        height = Math.min(height * 0.9, naturalHeight);\n        var imageData = {\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight,\n          aspectRatio: aspectRatio,\n          ratio: width / naturalWidth,\n          width: width,\n          height: height,\n          left: (viewerWidth - width) / 2,\n          top: (viewerHeight - height) / 2\n        };\n        var initialImageData = assign({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n\n      var image = this.image,\n          imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.left,\n        marginTop: imageData.top\n      }, getTransforms(imageData)));\n\n      if (done) {\n        if ((this.viewing || this.zooming) && this.options.transition) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      // this.image only defined after viewed\n      if (this.viewing || this.viewed) {\n        var image = this.image;\n\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }\n  };\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n  var handlers = {\n    click: function click(event) {\n      var target = event.target;\n      var options = this.options,\n          imageData = this.imageData;\n      var action = getData(target, DATA_ACTION); // Cancel the emulated click when the native click event was triggered.\n\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n\n        case 'hide':\n          this.hide();\n          break;\n\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          this.toggle();\n          break;\n\n        case 'reset':\n          this.reset();\n          break;\n\n        case 'prev':\n          this.prev(options.loop);\n          break;\n\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n\n        case 'next':\n          this.next(options.loop);\n          break;\n\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (this.played) {\n            this.stop();\n          }\n\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        }\n\n        this.toggle();\n      }\n    },\n    load: function load() {\n      var _this = this;\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n\n      var element = this.element,\n          options = this.options,\n          image = this.image,\n          index = this.index,\n          viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:absolute;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n\n      if (!this.fulled || !options.keyboard) {\n        return;\n      }\n\n      switch (event.keyCode || event.which || event.charCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n        // Space\n\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n\n          break;\n        // ArrowLeft\n\n        case 37:\n          this.prev(options.loop);\n          break;\n        // ArrowUp\n\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom in\n\n          this.zoom(options.zoomRatio, true);\n          break;\n        // ArrowRight\n\n        case 39:\n          this.next(options.loop);\n          break;\n        // ArrowDown\n\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom out\n\n          this.zoom(-options.zoomRatio, true);\n          break;\n        // Ctrl + 0\n\n        case 48: // Fall through\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.tagName.toLowerCase() === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var buttons = event.buttons,\n          button = event.button;\n\n      if (!this.viewed || this.showing || this.viewing || this.hiding // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      } // Prevent default behaviours as page zooming in touch devices.\n\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      var action = options.movable ? ACTION_MOVE : false;\n\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n          action = this.action;\n\n      if (!this.viewed || !action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n\n      var options = this.options,\n          action = this.action,\n          pointers = this.pointers;\n      var pointer;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = false; // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false; // This timeout will be cleared later when a native dblclick event is triggering\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK);\n            }, 50);\n          } else {\n            this.imageClicked = true; // The default timing of a double click in Windows is 500 ms\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK);\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n\n      if (!this.viewed) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, true, event);\n    }\n  };\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n\n      if (!this.ready) {\n        this.build();\n\n        if (this.ready) {\n          this.show(immediate);\n        }\n\n        return this;\n      }\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n\n      return this;\n    },\n\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n\n      this.hiding = true;\n\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var viewer = this.viewer;\n\n      if (options.transition && hasClass(this.image, CLASS_TRANSITION) && !immediate) {\n        var hidden = this.hidden.bind(this);\n\n        var hide = function hide() {\n          // XXX: It seems the `event.stopPropagation()` method does not work here\n          setTimeout(function () {\n            addListener(viewer, EVENT_TRANSITION_END, hidden, {\n              once: true\n            });\n            removeClass(viewer, CLASS_IN);\n          }, 0);\n        };\n\n        this.transitioning = {\n          abort: function abort() {\n            if (this.viewed) {\n              removeListener(this.image, EVENT_TRANSITION_END, hide);\n            } else {\n              removeListener(viewer, EVENT_TRANSITION_END, hidden);\n            }\n          }\n        }; // Note that the `CLASS_TRANSITION` class will be removed on pointer down (#255)\n\n        if (this.viewed) {\n          addListener(this.image, EVENT_TRANSITION_END, hide, {\n            once: true\n          });\n          this.zoomTo(0, false, false, true);\n        } else {\n          hide();\n        }\n      } else {\n        removeClass(viewer, CLASS_IN);\n        this.hidden();\n      }\n\n      return this;\n    },\n\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this = this;\n\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var element = this.element,\n          options = this.options,\n          title = this.title,\n          canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n\n      this.image = image;\n      removeClass(this.items[this.index], CLASS_ACTIVE);\n      addClass(item, CLASS_ACTIVE);\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n\n      canvas.innerHTML = '';\n      canvas.appendChild(image); // Center current item\n\n      this.renderList(); // Clear title\n\n      title.innerHTML = ''; // Generate title after viewed\n\n      var onViewed = function onViewed() {\n        var imageData = _this.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n\n      var onLoad;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n\n          if (image.complete) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n\n            if (this.timeout) {\n              clearTimeout(this.timeout);\n            }\n          }\n        }\n      };\n\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = this.load.bind(this), {\n          once: true\n        });\n\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        } // Make the image visible if it fails to load within 1s\n\n\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this.timeout = false;\n        }, 1000);\n      }\n\n      return this;\n    },\n\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * Move the image with relative offsets.\n     * @param {number} offsetX - The relative offset distance on the x-axis.\n     * @param {number} offsetY - The relative offset distance on the y-axis.\n     * @returns {Viewer} this\n     */\n    move: function move(offsetX, offsetY) {\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(offsetX) ? offsetX : imageData.left + Number(offsetX), isUndefined(offsetY) ? offsetY : imageData.top + Number(offsetY));\n      return this;\n    },\n\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The x-axis coordinate.\n     * @param {number} [y=x] - The y-axis coordinate.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.viewed && !this.played && this.options.movable) {\n        var changed = false;\n\n        if (isNumber(x)) {\n          imageData.left = x;\n          changed = true;\n        }\n\n        if (isNumber(y)) {\n          imageData.top = y;\n          changed = true;\n        }\n\n        if (changed) {\n          this.renderImage();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n      return this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this2 = this;\n\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _zoomable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n      var element = this.element,\n          options = this.options,\n          pointers = this.pointers,\n          imageData = this.imageData;\n      var width = imageData.width,\n          height = imageData.height,\n          left = imageData.left,\n          top = imageData.top,\n          naturalWidth = imageData.naturalWidth,\n          naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (_originalEvent && ratio > 0.95 && ratio < 1.05) {\n          ratio = 1;\n        }\n\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = width / naturalWidth;\n\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        this.zooming = true;\n\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          imageData.left -= offsetWidth * ((center.pageX - offset.left - left) / width);\n          imageData.top -= offsetHeight * ((center.pageY - offset.top - top) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.left -= offsetWidth / 2;\n          imageData.top -= offsetHeight / 2;\n        }\n\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this2.zooming = false;\n\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          });\n        });\n\n        if (hasTooltip) {\n          this.tooltip();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var imageData = this.imageData;\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.viewed && !this.played && this.options.rotatable) {\n        imageData.rotate = degree;\n        this.renderImage();\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.viewed && !this.played && this.options.scalable) {\n        var changed = false;\n\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          changed = true;\n        }\n\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          changed = true;\n        }\n\n        if (changed) {\n          this.renderImage();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Play the images\n     * @param {boolean} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this3 = this;\n\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isShown || this.played) {\n        return this;\n      }\n\n      var options = this.options,\n          player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n\n      if (fullscreen) {\n        this.requestFullscreen();\n      }\n\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        var play = function play() {\n          _this3.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index += 1;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n            play();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          play();\n        }\n      }\n\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this4 = this;\n\n      if (!this.played) {\n        return this;\n      }\n\n      var player = this.player;\n      this.played = false;\n      clearTimeout(this.playing);\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this4.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this5 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('style', '');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this5.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this6 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this6.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this7 = this;\n\n      var options = this.options,\n          tooltipBox = this.tooltipBox,\n          imageData = this.imageData;\n\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            _this7.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this7.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n        }\n\n        _this7.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n    // Toggle the image size between its natural size and initial size\n    toggle: function toggle() {\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.initialImageData.ratio, true);\n      } else {\n        this.zoomTo(1, true);\n      }\n\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this8 = this;\n\n      var element = this.element,\n          options = this.options,\n          isImg = this.isImg; // Destroy viewer if the target image was deleted\n\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this8, image)) {\n            images.push(image);\n          }\n        } else if (_this8.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n\n      if (!images.length) {\n        return this;\n      }\n\n      this.images = images;\n      this.length = images.length;\n\n      if (this.ready) {\n        var indexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n\n          if (image && img) {\n            if (image.src !== img.src) {\n              indexes.push(i);\n            }\n          } else {\n            indexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var index = indexes.indexOf(this.index);\n\n              if (index >= 0) {\n                this.viewed = false;\n                this.view(Math.max(this.index - (index + 1), 0));\n              } else {\n                addClass(this.items[this.index], CLASS_ACTIVE);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n          options = this.options;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      this.destroyed = true;\n\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n\n      return url;\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.initialBodyPaddingRight;\n    },\n    shown: function shown() {\n      var element = this.element,\n          options = this.options;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n          options = this.options;\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.close();\n      this.unbind();\n      addClass(this.viewer, CLASS_HIDE);\n      this.resetList();\n      this.resetImage();\n      this.hiding = false;\n\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_HIDDEN);\n      }\n    },\n    requestFullscreen: function requestFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement; // Element.requestFullscreen()\n\n        if (documentElement.requestFullscreen) {\n          documentElement.requestFullscreen();\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          this.move(offsetX, offsetY);\n          break;\n        // Zoom the current image\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, event);\n          break;\n\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n\n            break;\n          }\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n          viewerData = this.viewerData;\n      return this.length > 1 && imageData.left >= 0 && imageData.top >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n  var AnotherViewer = WINDOW.Viewer;\n\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Viewer);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.init();\n    }\n\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var element = this.element,\n            options = this.options;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this;\n        var isImg = element.tagName.toLowerCase() === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody(); // Override `transition` option if it is not supported\n\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n\n        if (options.inline) {\n          var count = 0;\n\n          var progress = function progress() {\n            count += 1;\n\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              }; // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n\n                _this.build();\n              }, 0);\n            }\n          };\n\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              addListener(image, EVENT_LOAD, progress, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n\n            if (target.tagName.toLowerCase() === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n\n          if (!container) {\n            container = this.body;\n          }\n\n          container.appendChild(viewer);\n        }\n\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n\n        this.ready = true;\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Viewer;\n  }();\n\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n  return Viewer;\n});","map":{"version":3,"sources":["/Users/ss/Desktop/work/dslm/node_modules/viewerjs/dist/viewer.js"],"names":["global","factory","exports","module","define","amd","self","Viewer","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_defineProperty","value","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","DEFAULTS","backdrop","button","navbar","title","toolbar","className","container","fullscreen","inheritedAttributes","initialViewIndex","inline","interval","keyboard","loading","loop","minWidth","minHeight","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","slideOnTouch","toggleOnDblclick","tooltip","transition","zIndex","zIndexInline","zoomRatio","minZoomRatio","maxZoomRatio","url","ready","show","shown","hide","hidden","view","viewed","zoom","zoomed","TEMPLATE","IS_BROWSER","window","document","WINDOW","IS_TOUCH_DEVICE","documentElement","HAS_POINTER_EVENT","NAMESPACE","ACTION_MOVE","ACTION_SWITCH","ACTION_ZOOM","CLASS_ACTIVE","concat","CLASS_CLOSE","CLASS_FADE","CLASS_FIXED","CLASS_FULLSCREEN","CLASS_FULLSCREEN_EXIT","CLASS_HIDE","CLASS_HIDE_MD_DOWN","CLASS_HIDE_SM_DOWN","CLASS_HIDE_XS_DOWN","CLASS_IN","CLASS_INVISIBLE","CLASS_LOADING","CLASS_MOVE","CLASS_OPEN","CLASS_SHOW","CLASS_TRANSITION","EVENT_CLICK","EVENT_DBLCLICK","EVENT_DRAG_START","EVENT_HIDDEN","EVENT_HIDE","EVENT_KEY_DOWN","EVENT_LOAD","EVENT_TOUCH_START","EVENT_TOUCH_MOVE","EVENT_TOUCH_END","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_READY","EVENT_RESIZE","EVENT_SHOW","EVENT_SHOWN","EVENT_TRANSITION_END","EVENT_VIEW","EVENT_VIEWED","EVENT_WHEEL","EVENT_ZOOM","EVENT_ZOOMED","DATA_ACTION","REGEXP_SPACES","BUTTONS","isString","isNaN","Number","isNumber","isUndefined","isObject","hasOwnProperty","isPlainObject","_constructor","call","error","isFunction","data","callback","Array","isArray","assign","_len","args","_key","arg","REGEXP_SUFFIX","setStyle","element","styles","style","property","test","escapeHTMLEntities","replace","hasClass","classList","contains","indexOf","addClass","elem","add","trim","removeClass","remove","toggleClass","added","REGEXP_HYPHENATE","hyphenate","toLowerCase","getData","name","dataset","getAttribute","setData","setAttribute","onceSupported","supported","once","listener","options","get","set","addEventListener","removeEventListener","removeListener","type","undefined","handler","split","event","listeners","addListener","_handler","_element$listeners","_len2","_key2","dispatchEvent","Event","CustomEvent","detail","bubbles","cancelable","createEvent","initCustomEvent","getOffset","box","getBoundingClientRect","left","pageXOffset","clientLeft","top","pageYOffset","clientTop","getTransforms","_ref","rotate","scaleX","scaleY","translateX","translateY","values","transform","join","WebkitTransform","msTransform","getImageNameFromURL","decodeURIComponent","IS_SAFARI","navigator","userAgent","getImageNaturalSizes","image","newImage","createElement","naturalWidth","naturalHeight","body","onload","width","height","removeChild","src","cssText","appendChild","getResponsiveClass","getMaxZoomRatio","pointers","pointers2","ratios","pointer","pointerId","pointer2","x1","Math","abs","startX","y1","startY","x2","endX","y2","endY","z1","sqrt","z2","ratio","sort","a","b","getPointer","_ref2","endOnly","pageX","pageY","end","timeStamp","Date","now","getPointersCenter","count","_ref3","render","initContainer","initViewer","initList","renderViewer","initBody","ownerDocument","scrollbarWidth","innerWidth","clientWidth","initialBodyPaddingRight","paddingRight","initialBodyComputedPaddingRight","getComputedStyle","containerData","innerHeight","parent","viewerData","max","offsetWidth","offsetHeight","parentData","fulled","viewer","_this","list","items","innerHTML","images","index","alt","getImageURL","item","img","firstElementChild","loadImage","renderList","outerWidth","resetList","initImage","done","_this2","footerHeight","footer","viewerWidth","viewerHeight","oldImageData","imageData","sizingImage","imageInitializing","abort","aspectRatio","min","initialImageData","renderImage","_this3","marginLeft","marginTop","viewing","zooming","onTransitionEnd","imageRendering","resetImage","parentNode","events","bind","canvas","onClick","click","onDragStart","dragstart","onPointerDown","pointerdown","onPointerMove","pointermove","onPointerUp","pointerup","onKeyDown","keydown","onResize","resize","onWheel","wheel","passive","capture","onDblclick","dblclick","unbind","handlers","action","isTrusted","clearTimeout","clickCanvasTimeout","played","stop","exit","full","toggle","reset","prev","play","next","preventDefault","doubleClickImageTimeout","load","timeout","originalImage","parentWidth","parentHeight","filled","keyCode","which","charCode","ctrlKey","tagName","buttons","showing","hiding","pointerType","changedTouches","touch","identifier","isSwitchable","change","imageClicked","setTimeout","isShown","close","open","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","player","getElementsByTagName","_this4","wheeling","delta","deltaY","wheelDelta","methods","immediate","build","transitioning","initialOffsetWidth","zoomTo","querySelector","onViewed","onLoad","complete","maxIndex","move","offsetX","offsetY","moveTo","x","y","changed","hasTooltip","_originalEvent","_zoomable","newWidth","newHeight","oldRatio","originalEvent","offset","center","degree","rotateTo","_scaleX","scale","_scaleY","total","onLoadWhenPlay","requestFullscreen","referrerPolicy","playing","exitFullscreen","_this5","_this6","_this7","tooltipBox","textContent","round","tooltipping","fading","update","_this8","isImg","destroy","querySelectorAll","indexes","destroyed","delaying","initializing","onStart","others","parseFloat","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","mozRequestFullScreen","msRequestFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","absoluteOffsetX","p","AnotherViewer","nodeType","Error","init","progress","template","custom","zoomButtons","slice","rotateButtons","scaleButtons","deep","size","rotates","position","insertBefore","nextSibling","noConflict","setDefaults"],"mappings":"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","sourcesContent":["/*!\n * Viewer.js v1.6.1\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2020-06-14T07:47:18.114Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Viewer = factory());\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n\n    /**\n     * Enable to request fullscreen when play.\n     * @type {boolean}\n     */\n    fullscreen: true,\n\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n\n    /**\n     * Define the initial index of image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    zoom: null,\n    zoomed: null\n  };\n\n  var TEMPLATE = '<div class=\"viewer-container\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\"></div>' + '<div role=\"button\" class=\"viewer-button\" data-viewer-action=\"mix\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer'; // Actions\n\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom'; // Classes\n\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\"); // Events\n\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_HIDE = 'hide';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_READY = 'ready';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_WHEEL = 'wheel';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed'; // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\"); // RegExps\n\n  var REGEXP_SPACES = /\\s\\s*/; // Misc\n\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * Check if the given value is not a number.\n   */\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n          var length = data.length;\n          var i;\n\n          for (i = 0; i < length; i += 1) {\n            if (callback.call(data, data[i], i, data) === false) {\n              break;\n            }\n          }\n        } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return obj;\n  };\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n  function dispatchEvent(element, type, data) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, {\n        detail: data,\n        bubbles: true,\n        cancelable: true\n      });\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n  var IS_SAFARI = WINDOW.navigator && /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img'); // Modern browsers (except Safari)\n\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n\n    var body = document.body || document.documentElement;\n\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src; // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n\n    return newImage;\n  }\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n\n      default:\n        return '';\n    }\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n          parent = this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n\n      var element = this.element,\n          options = this.options,\n          list = this.list;\n      var items = []; // initList may be called in this.update, so should keep idempotent\n\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n\n        var url = _this.getImageURL(image);\n\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n          img.src = src || url;\n          img.alt = alt;\n          img.setAttribute('data-index', index);\n          img.setAttribute('data-original-url', url || src);\n          img.setAttribute('data-viewer-action', 'view');\n          img.setAttribute('role', 'button');\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        setData(image, 'filled', true);\n\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n\n        addListener(image, EVENT_LOAD, function (event) {\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n      });\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList(index) {\n      var i = index || this.index;\n      var width = this.items[i].offsetWidth || 30;\n      var outerWidth = width + 1; // 1 pixel of `margin-left` width\n      // Place the active item in the center of the screen\n\n      setStyle(this.list, assign({\n        width: outerWidth * this.length\n      }, getTransforms({\n        translateX: (this.viewerData.width - width) / 2 - outerWidth * i\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n\n      var options = this.options,\n          image = this.image,\n          viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = Math.min(width * 0.9, naturalWidth);\n        height = Math.min(height * 0.9, naturalHeight);\n        var imageData = {\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight,\n          aspectRatio: aspectRatio,\n          ratio: width / naturalWidth,\n          width: width,\n          height: height,\n          left: (viewerWidth - width) / 2,\n          top: (viewerHeight - height) / 2\n        };\n        var initialImageData = assign({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n\n      var image = this.image,\n          imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.left,\n        marginTop: imageData.top\n      }, getTransforms(imageData)));\n\n      if (done) {\n        if ((this.viewing || this.zooming) && this.options.transition) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      // this.image only defined after viewed\n      if (this.viewing || this.viewed) {\n        var image = this.image;\n\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n\n  var handlers = {\n    click: function click(event) {\n      var target = event.target;\n      var options = this.options,\n          imageData = this.imageData;\n      var action = getData(target, DATA_ACTION); // Cancel the emulated click when the native click event was triggered.\n\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n\n        case 'hide':\n          this.hide();\n          break;\n\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          this.toggle();\n          break;\n\n        case 'reset':\n          this.reset();\n          break;\n\n        case 'prev':\n          this.prev(options.loop);\n          break;\n\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n\n        case 'next':\n          this.next(options.loop);\n          break;\n\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (this.played) {\n            this.stop();\n          }\n\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        }\n\n        this.toggle();\n      }\n    },\n    load: function load() {\n      var _this = this;\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n\n      var element = this.element,\n          options = this.options,\n          image = this.image,\n          index = this.index,\n          viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:absolute;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n\n      if (!this.fulled || !options.keyboard) {\n        return;\n      }\n\n      switch (event.keyCode || event.which || event.charCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n        // Space\n\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n\n          break;\n        // ArrowLeft\n\n        case 37:\n          this.prev(options.loop);\n          break;\n        // ArrowUp\n\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom in\n\n          this.zoom(options.zoomRatio, true);\n          break;\n        // ArrowRight\n\n        case 39:\n          this.next(options.loop);\n          break;\n        // ArrowDown\n\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom out\n\n          this.zoom(-options.zoomRatio, true);\n          break;\n        // Ctrl + 0\n\n        case 48: // Fall through\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.tagName.toLowerCase() === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var buttons = event.buttons,\n          button = event.button;\n\n      if (!this.viewed || this.showing || this.viewing || this.hiding // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      } // Prevent default behaviours as page zooming in touch devices.\n\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      var action = options.movable ? ACTION_MOVE : false;\n\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n          action = this.action;\n\n      if (!this.viewed || !action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n\n      var options = this.options,\n          action = this.action,\n          pointers = this.pointers;\n      var pointer;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = false; // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false; // This timeout will be cleared later when a native dblclick event is triggering\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK);\n            }, 50);\n          } else {\n            this.imageClicked = true; // The default timing of a double click in Windows is 500 ms\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK);\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n\n      if (!this.viewed) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, true, event);\n    }\n  };\n\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n\n      if (!this.ready) {\n        this.build();\n\n        if (this.ready) {\n          this.show(immediate);\n        }\n\n        return this;\n      }\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n\n      return this;\n    },\n\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n\n      this.hiding = true;\n\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var viewer = this.viewer;\n\n      if (options.transition && hasClass(this.image, CLASS_TRANSITION) && !immediate) {\n        var hidden = this.hidden.bind(this);\n\n        var hide = function hide() {\n          // XXX: It seems the `event.stopPropagation()` method does not work here\n          setTimeout(function () {\n            addListener(viewer, EVENT_TRANSITION_END, hidden, {\n              once: true\n            });\n            removeClass(viewer, CLASS_IN);\n          }, 0);\n        };\n\n        this.transitioning = {\n          abort: function abort() {\n            if (this.viewed) {\n              removeListener(this.image, EVENT_TRANSITION_END, hide);\n            } else {\n              removeListener(viewer, EVENT_TRANSITION_END, hidden);\n            }\n          }\n        }; // Note that the `CLASS_TRANSITION` class will be removed on pointer down (#255)\n\n        if (this.viewed) {\n          addListener(this.image, EVENT_TRANSITION_END, hide, {\n            once: true\n          });\n          this.zoomTo(0, false, false, true);\n        } else {\n          hide();\n        }\n      } else {\n        removeClass(viewer, CLASS_IN);\n        this.hidden();\n      }\n\n      return this;\n    },\n\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this = this;\n\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var element = this.element,\n          options = this.options,\n          title = this.title,\n          canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n\n      this.image = image;\n      removeClass(this.items[this.index], CLASS_ACTIVE);\n      addClass(item, CLASS_ACTIVE);\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n\n      canvas.innerHTML = '';\n      canvas.appendChild(image); // Center current item\n\n      this.renderList(); // Clear title\n\n      title.innerHTML = ''; // Generate title after viewed\n\n      var onViewed = function onViewed() {\n        var imageData = _this.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n\n      var onLoad;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n\n          if (image.complete) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n\n            if (this.timeout) {\n              clearTimeout(this.timeout);\n            }\n          }\n        }\n      };\n\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = this.load.bind(this), {\n          once: true\n        });\n\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        } // Make the image visible if it fails to load within 1s\n\n\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this.timeout = false;\n        }, 1000);\n      }\n\n      return this;\n    },\n\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * Move the image with relative offsets.\n     * @param {number} offsetX - The relative offset distance on the x-axis.\n     * @param {number} offsetY - The relative offset distance on the y-axis.\n     * @returns {Viewer} this\n     */\n    move: function move(offsetX, offsetY) {\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(offsetX) ? offsetX : imageData.left + Number(offsetX), isUndefined(offsetY) ? offsetY : imageData.top + Number(offsetY));\n      return this;\n    },\n\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The x-axis coordinate.\n     * @param {number} [y=x] - The y-axis coordinate.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.viewed && !this.played && this.options.movable) {\n        var changed = false;\n\n        if (isNumber(x)) {\n          imageData.left = x;\n          changed = true;\n        }\n\n        if (isNumber(y)) {\n          imageData.top = y;\n          changed = true;\n        }\n\n        if (changed) {\n          this.renderImage();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n      return this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this2 = this;\n\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _zoomable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n      var element = this.element,\n          options = this.options,\n          pointers = this.pointers,\n          imageData = this.imageData;\n      var width = imageData.width,\n          height = imageData.height,\n          left = imageData.left,\n          top = imageData.top,\n          naturalWidth = imageData.naturalWidth,\n          naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (_originalEvent && ratio > 0.95 && ratio < 1.05) {\n          ratio = 1;\n        }\n\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = width / naturalWidth;\n\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        this.zooming = true;\n\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          imageData.left -= offsetWidth * ((center.pageX - offset.left - left) / width);\n          imageData.top -= offsetHeight * ((center.pageY - offset.top - top) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.left -= offsetWidth / 2;\n          imageData.top -= offsetHeight / 2;\n        }\n\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this2.zooming = false;\n\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          });\n        });\n\n        if (hasTooltip) {\n          this.tooltip();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var imageData = this.imageData;\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.viewed && !this.played && this.options.rotatable) {\n        imageData.rotate = degree;\n        this.renderImage();\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.viewed && !this.played && this.options.scalable) {\n        var changed = false;\n\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          changed = true;\n        }\n\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          changed = true;\n        }\n\n        if (changed) {\n          this.renderImage();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Play the images\n     * @param {boolean} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this3 = this;\n\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isShown || this.played) {\n        return this;\n      }\n\n      var options = this.options,\n          player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n\n      if (fullscreen) {\n        this.requestFullscreen();\n      }\n\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        var play = function play() {\n          _this3.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index += 1;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n            play();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          play();\n        }\n      }\n\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this4 = this;\n\n      if (!this.played) {\n        return this;\n      }\n\n      var player = this.player;\n      this.played = false;\n      clearTimeout(this.playing);\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this4.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this5 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('style', '');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this5.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this6 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this6.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this7 = this;\n\n      var options = this.options,\n          tooltipBox = this.tooltipBox,\n          imageData = this.imageData;\n\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            _this7.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this7.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n        }\n\n        _this7.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n    // Toggle the image size between its natural size and initial size\n    toggle: function toggle() {\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.initialImageData.ratio, true);\n      } else {\n        this.zoomTo(1, true);\n      }\n\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this8 = this;\n\n      var element = this.element,\n          options = this.options,\n          isImg = this.isImg; // Destroy viewer if the target image was deleted\n\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this8, image)) {\n            images.push(image);\n          }\n        } else if (_this8.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n\n      if (!images.length) {\n        return this;\n      }\n\n      this.images = images;\n      this.length = images.length;\n\n      if (this.ready) {\n        var indexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n\n          if (image && img) {\n            if (image.src !== img.src) {\n              indexes.push(i);\n            }\n          } else {\n            indexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var index = indexes.indexOf(this.index);\n\n              if (index >= 0) {\n                this.viewed = false;\n                this.view(Math.max(this.index - (index + 1), 0));\n              } else {\n                addClass(this.items[this.index], CLASS_ACTIVE);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n          options = this.options;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      this.destroyed = true;\n\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n\n      return url;\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.initialBodyPaddingRight;\n    },\n    shown: function shown() {\n      var element = this.element,\n          options = this.options;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n          options = this.options;\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.close();\n      this.unbind();\n      addClass(this.viewer, CLASS_HIDE);\n      this.resetList();\n      this.resetImage();\n      this.hiding = false;\n\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_HIDDEN);\n      }\n    },\n    requestFullscreen: function requestFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement; // Element.requestFullscreen()\n\n        if (documentElement.requestFullscreen) {\n          documentElement.requestFullscreen();\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          this.move(offsetX, offsetY);\n          break;\n        // Zoom the current image\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, event);\n          break;\n\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n\n            break;\n          }\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n          viewerData = this.viewerData;\n      return this.length > 1 && imageData.left >= 0 && imageData.top >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n\n  var AnotherViewer = WINDOW.Viewer;\n\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Viewer);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.init();\n    }\n\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var element = this.element,\n            options = this.options;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this;\n        var isImg = element.tagName.toLowerCase() === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody(); // Override `transition` option if it is not supported\n\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n\n        if (options.inline) {\n          var count = 0;\n\n          var progress = function progress() {\n            count += 1;\n\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              }; // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n\n                _this.build();\n              }, 0);\n            }\n          };\n\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              addListener(image, EVENT_LOAD, progress, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n\n            if (target.tagName.toLowerCase() === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n\n          if (!container) {\n            container = this.body;\n          }\n\n          container.appendChild(viewer);\n        }\n\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n\n        this.ready = true;\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Viewer;\n  }();\n\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n\n  return Viewer;\n\n})));\n"]},"metadata":{},"sourceType":"script"}